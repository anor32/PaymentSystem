<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<div style="margin: auto;border: red solid 1px;border-radius: 50px; width: 300px;padding: 30px">
    <h4> {{ object.name }}</h4>
    <p>{{ object.description}}</p>
    <p>{{object.price}}</p>
    <div style="padding-left:50%;">

        <button type="submit" class="btn btn-default" id="buy-button">Buy</button>


    </div>
</div>

<!--<script type="text/javascript">-->
<!--         var buyButton = document.getElementById('buy-button');-->
<!--          buyButton.addEventListener('click', async function () {-->

<!--              var response = await fetch('/items/buy/{{object.pk}}')-->
<!--              var stripeData = await response.json();-->
<!--              var stripe = Stripe('pk_test_a9nwZVa5O7b0xz3lxl318KSU00x1L9ZWsF');-->
<!--              stripe.redirectToCheckout({ sessionId: stripeData.session.id })-->


<!--          })-->
<!--          // var stripe = Stripe('pk_test_a9nwZVa5O7b0xz3lxl318KSU00x1L9ZWsF');-->
<!--          // var buyButton = document.getElementById('buy-button');-->
<!--          // buyButton.addEventListener('click', function() {-->
<!--          //   // Create a new Checkout Session using the server-side endpoint-->
<!--          //   // Redirect to Stripe Session Checkout-->
<!--          //   fetch('/buy/1', {method: 'GET'})-->
<!--          //   .then(response => return response.json())-->
<!--          //   .then(session => stripe.redirectToCheckout({ sessionId: session.id }))-->
<!--          // });-->
<!--</script>-->
<script src="https://js.stripe.com/v3/"></script>
<script type="text/javascript">
      var stripe = Stripe('pk_test_51Sh4z0FGGmR1juRjXNeOyIfAcMJe0UhaCk4X7nYKLtdsw7wNZHhbGgYZDQwPxiDQt2uUk3Onmq2lA1Cf9lmBFQ2200ZGiFQ3ne');
      var buyButton = document.getElementById('buy-button');
      buyButton.addEventListener('click', function() {

         fetch("http://127.0.0.1:8000/items/buy/{{object.pk}}", {method: 'GET'})
        .then(response =>  response.json())
        .then(session => stripe.redirectToCheckout({ sessionId: session.session.id }))

      });
    </script>

</body>

</html>